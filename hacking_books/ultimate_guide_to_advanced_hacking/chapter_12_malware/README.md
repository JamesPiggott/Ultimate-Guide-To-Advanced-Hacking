# Chapter 12: Malware

## 12.1 Introduction
Malware, short for **malicious software**, refers to any software designed to disrupt, damage, or gain unauthorized access to computer systems. Over the years, malware has evolved from simple self-replicating programs to highly sophisticated threats used in cyber warfare, espionage, and financial fraud.

### **How Malware Works**
Malware operates through various mechanisms depending on its type. Below is an overview of the key malware categories:

- **Viruses**: A virus attaches itself to legitimate files and spreads when those files are executed. It typically modifies other files or system components to propagate. Early examples include the **Brain Virus (1986)** and the **Michelangelo Virus (1991)**.

- **Worms**: Unlike viruses, worms do not need a host file and can spread autonomously over networks. The **Morris Worm (1988)** was one of the first notable worms, infecting thousands of Unix machines by exploiting known vulnerabilities.

- **Trojans**: A Trojan disguises itself as legitimate software but secretly executes malicious functions. Unlike worms and viruses, Trojans do not replicate on their own. The **Zeus Trojan (2007)** is a well-known banking Trojan that stole financial credentials.

- **Rootkits**: These are stealthy malware programs that gain deep access to a system (often at the kernel level) to hide other malware and evade detection. The **TDSS Rootkit** is an example that remained undetected for years.

- **Ransomware**: Encrypts a victim’s files and demands a ransom for decryption. Examples include **WannaCry (2017)** and **Ryuk (2018)**.

- **Spyware & Keyloggers**: Spyware collects user data without consent, often used for surveillance or financial theft. Keyloggers record keystrokes to steal passwords. The **FinSpy spyware** is an advanced surveillance tool used by governments.

- **Botnets**: A botnet is a network of compromised machines controlled remotely. These are often used for **DDoS attacks**, spam distribution, or cryptocurrency mining. The **Mirai Botnet (2016)** infected IoT devices to launch large-scale attacks.

Each of these malware types has distinct propagation methods, attack strategies, and countermeasures, making cybersecurity an ever-evolving challenge.

## **References**
- [The History of the Morris Worm](https://www.csoonline.com/article/3441052/the-morris-worm-30-years-later.html)
- [Evolution of Ransomware Attacks](https://www.cisa.gov/stopransomware)
- [The Zeus Trojan and Banking Malware](https://www.secureworks.com/research/threat-profiles/zeus-trojan)
- [A Technical Overview of Mirai Botnet](https://www.usenix.org/conference/woot17/technical-sessions/presentation/santanna)

---

## 12.2 Hands-On: Detecting Malicious Macros in Excel Files

### Step 1: Inspecting Macros in an Excel File
To check for suspicious macros in an Excel file, use `oletools`:

    pip install oletools
    olevba suspicious_file.xlsm

This will display any **suspicious VBA macros** that might execute malware.

---

### Step 2: Extracting Macros Manually
You can extract macros manually using Python:

    import olefile

    o = olefile.OleFileIO("suspicious_file.xlsm")
    for entry in o.listdir():
        if entry[0] == "VBA":
            print("Potential VBA macro found:", entry)


## 12.3 Prevention & Mitigation
To protect against macro-based malware:

1. **Disable Macros by Default**: In Microsoft Office settings, disable all macros except for trusted sources.
2. **Use Email Filtering**: Block email attachments with `.xlsm`, `.docm`, and other macro-enabled formats.
3. **Perform File Analysis**: Use sandboxes like **Cuckoo Sandbox** to analyze suspicious files.

---

## 12.4 References

- [Microsoft Security Guide on Macro Malware](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/office-macro-malware)
- [Olevba Documentation](https://github.com/decalage2/oletools/wiki/olevba)

---

**Next Chapter →** Chapter 13: Encryption
